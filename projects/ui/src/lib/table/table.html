<div [attr.data-has-pagination]="hasPagination ? true : null" [attr.data-size]="size || 'medium'">
    <div data-scroll-container>
        <table
            [attr.aria-colcount]="totalColumns"
            [attr.aria-rowcount]="data.length"
            [style.gridTemplateColumns]="gridTemplateColumns()">
            @if (title) {
                <caption>
                    {{
                        title
                    }}
                </caption>
            }
            <thead>
                <tr>
                    @for (column of normalizedColumns; track $index) {
                        <th
                            [attr.data-align]="column.align || null"
                            [attr.data-sortable]="column.sort ? true : null"
                            scope="col"
                            [attr.aria-sort]="ariaSortForColumn(column.key)">
                            @if (column.sort) {
                                <button type="button" (click)="toggleSorting(column.key)">
                                    {{ column.label }}
                                    @if (sortIcon(column.key)) {
                                        <span aria-hidden="true" data-sort-icon>
                                            <ui-icon [icon]="sortIcon(column.key)!"></ui-icon>
                                        </span>
                                    }
                                </button>
                            } @else {
                                {{ column.label }}
                            }
                        </th>
                    }
                </tr>
            </thead>
            <tbody>
                @for (row of rows; track row.id) {
                    <tr>
                        @for (column of normalizedColumns; track column.key) {
                            <td
                                [attr.data-align]="column.align || 'left'"
                                [attr.data-cell]="column.key"
                                [attr.data-valign]="column.valign || 'center'">
                                {{ formatCell(column.formatter ? column.formatter(row, size) : $any(row)[column.key]) }}
                            </td>
                        }
                    </tr>
                }
            </tbody>
        </table>

        @if (hasPagination) {
            <div data-pagination role="group">
                <div data-pagination-label>Showing {{ startRow() }}-{{ endRow() }} of {{ data.length }} results</div>
                <ui-pagination
                    [value]="pageIndex + 1"
                    [numPages]="totalPages"
                    (onChange)="setPageIndex($event - 1)"></ui-pagination>
            </div>
        }
    </div>
</div>
